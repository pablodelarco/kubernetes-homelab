config:
  bookmarks:
    - Developer:
        - GitHub:
            - abbr: GH
              href: https://github.com/pablodelarco/kubernetes-homelab
        - Kubernetes:
            - abbr: K8s
              href: https://kubernetes.io/docs/
    - Media:
        - Jellyfin Docs:
            - abbr: JF
              href: https://jellyfin.org/docs/
        - Servarr Wiki:
            - abbr: ARR
              href: https://wiki.servarr.com/
    - Monitoring:
        - Grafana:
            - abbr: GR
              href: https://grafana.com/grafana/dashboards/

  services:
    - Infra:
        - Home Assistant:
            icon: home-assistant.png
            href: http://ha.homelab/
            description: Home automation
            widget:
              type: homeassistant
              url: http://home-assistant.home-assistant.svc.cluster.local
              key: "{{HOMEPAGE_VAR_HOMEASSISTANT_TOKEN}}"
        - ESPHome:
            icon: esphome.png
            href: http://esphome.homelab/
            description: IoT devices

    - CI/CD:
        - GitHub:
            icon: github.png
            href: https://github.com/pablodelarco/kubernetes-homelab
            description: Git repository
        - ArgoCD:
            icon: argocd.png
            href: http://argocd.homelab/
            description: GitOps CD

    - Storage:
        - Synology:
            icon: synology.png
            href: http://192.168.1.106:5000/
            description: NAS storage
        - MinIO:
            icon: minio.png
            href: http://minio-console.homelab/
            description: S3 object storage
        - Longhorn:
            icon: longhorn.png
            href: http://longhorn.homelab/
            description: Block storage
            widget:
              type: longhorn
              url: http://longhorn-frontend.longhorn-system.svc.cluster.local

    - Networking:
        - AdGuard Home:
            icon: adguard-home.png
            href: http://adguard.homelab/
            description: DNS & ad blocking
            widget:
              type: adguard
              url: http://adguard-home.adguard-home.svc.cluster.local:3000

    - Monitoring:
        - Uptime Kuma:
            icon: uptime-kuma.png
            href: http://uptime.homelab/
            description: Uptime monitoring
            widget:
              type: uptimekuma
              url: http://uptime-kuma.uptime-kuma.svc.cluster.local:3001
              slug: homelab
        - Grafana:
            icon: grafana.png
            href: http://grafana.homelab/
            description: Dashboards
            widget:
              type: grafana
              url: http://monitoring-grafana.monitoring.svc.cluster.local
              username: "{{HOMEPAGE_VAR_GRAFANA_USER}}"
              password: "{{HOMEPAGE_VAR_GRAFANA_PASSWORD}}"
        - Prometheus:
            icon: prometheus.png
            href: http://prometheus.homelab/
            description: Metrics
            widget:
              type: prometheus
              url: http://prometheus-operated.monitoring.svc.cluster.local:9090

    - Media:
        - Jellyfin:
            icon: jellyfin.png
            href: http://jellyfin.homelab/
            description: Media server
            widget:
              type: jellyfin
              url: http://jellyfin.media.svc.cluster.local:8096
              key: "{{HOMEPAGE_VAR_JELLYFIN_API_KEY}}"
              enableBlocks: true
              enableNowPlaying: true
        - Jellyseerr:
            icon: jellyseerr.png
            href: http://jellyseerr.homelab/
            description: Media requests
            widget:
              type: jellyseerr
              url: http://jellyseerr.media.svc.cluster.local:5055
              key: "{{HOMEPAGE_VAR_JELLYSEERR_API_KEY}}"
        - Radarr:
            icon: radarr.png
            href: http://radarr.homelab/
            description: Movies
            widget:
              type: radarr
              url: http://radarr.media.svc.cluster.local
              key: "{{HOMEPAGE_VAR_RADARR_API_KEY}}"
        - Bazarr:
            icon: bazarr.png
            href: http://bazarr.homelab/
            description: Subtitles
            widget:
              type: bazarr
              url: http://bazarr.media.svc.cluster.local:6767
              key: "{{HOMEPAGE_VAR_BAZARR_API_KEY}}"
        - qBittorrent:
            icon: qbittorrent.png
            href: http://qbitt.homelab/
            description: Torrent client
            widget:
              type: qbittorrent
              url: http://qbitt.media.svc.cluster.local
        - Jackett:
            icon: jackett.png
            href: http://jackett.homelab/
            description: Indexer proxy

  widgets:
    - kubernetes:
        cluster:
          show: true
          cpu: true
          memory: true
          showLabel: true
          label: "cluster"
        nodes:
          show: true
          cpu: true
          memory: true
          showLabel: true

  # Kubernetes integration settings
  kubernetes:
    mode: cluster

  # General settings
  settings:
    title: "Pablo's Homelab"
    favicon: https://raw.githubusercontent.com/walkxcode/dashboard-icons/main/png/kubernetes.png
    theme: dark
    color: slate
    headerStyle: boxed
    hideVersion: true
    layout:
      Infra:
        style: row
        columns: 2
      CI/CD:
        style: row
        columns: 2
      Storage:
        style: row
        columns: 3
      Networking:
        style: row
        columns: 1
      Monitoring:
        style: row
        columns: 3
      Media:
        style: row
        columns: 6

# Environment variables loaded from Secret (created manually, not in Git)
# Create the secret with: kubectl apply -f homepage-secrets.yaml (keep this file local only!)
envFrom:
  - secretRef:
      name: homepage-secrets

# The service account is necessary to allow discovery of other services
serviceAccount:
  create: true
  name: homepage

# This enables the service account to access the necessary resources
enableRbac: true

ingress:
  main:
    # Disabled - using Cilium Gateway API instead
    enabled: false

persistence:
  logs:
    enabled: true
    type: pvc
    existingClaim: homepage  # Use manual PVC -> creates volume 'pvc-homepage'
    mountPath: /app/config/logs


controller:
  annotations:
    configmap-checksum: '{{ include (print $.Template.BasePath "/configmap.yaml") . | sha256sum }}'

# Prefer scheduling on worker node to balance cluster load
affinity:
  nodeAffinity:
    preferredDuringSchedulingIgnoredDuringExecution:
      - weight: 100
        preference:
          matchExpressions:
            - key: kubernetes.io/hostname
              operator: In
              values:
                - worker





