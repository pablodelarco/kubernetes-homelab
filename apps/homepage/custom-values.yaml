config:
  bookmarks: []

  services:
    # Column 1: Home
    - Home:
        - AdGuard Home:
            icon: adguard-home.png
            href: http://adguard.homelab/
            description: DNS & ad blocking
            siteMonitor: http://adguard-home.adguard-home.svc.cluster.local:3000
            widget:
              type: adguard
              url: http://adguard-home.adguard-home.svc.cluster.local:3000
              username: "{{HOMEPAGE_VAR_ADGUARD_USER}}"
              password: "{{HOMEPAGE_VAR_ADGUARD_PASSWORD}}"
        - Home Assistant:
            icon: home-assistant.png
            href: http://ha.homelab/
            description: Home automation
            siteMonitor: http://home-assistant.home-assistant.svc.cluster.local
            widget:
              type: homeassistant
              url: http://home-assistant.home-assistant.svc.cluster.local
              key: "{{HOMEPAGE_VAR_HOMEASSISTANT_TOKEN}}"
        - Uptime Kuma:
            icon: uptime-kuma.png
            href: http://uptime.homelab/
            description: Systems monitoring
            siteMonitor: http://uptime-kuma.uptime-kuma.svc.cluster.local:3001
            widget:
              type: uptimekuma
              url: http://uptime-kuma.uptime-kuma.svc.cluster.local:3001
              slug: homelab
              key: "{{HOMEPAGE_VAR_UPTIMEKUMA_API_KEY}}"

    # Column 2: Media
    - Media Processing:
        - Radarr:
            icon: radarr.png
            href: http://radarr.homelab/
            description: Movies automation
            siteMonitor: http://radarr.media.svc.cluster.local
            widget:
              type: radarr
              url: http://radarr.media.svc.cluster.local
              key: "{{HOMEPAGE_VAR_RADARR_API_KEY}}"
        - Bazarr:
            icon: bazarr.png
            href: http://bazarr.homelab/
            description: Subtitles management
            siteMonitor: http://bazarr.media.svc.cluster.local:6767
            widget:
              type: bazarr
              url: http://bazarr.media.svc.cluster.local:6767
              key: "{{HOMEPAGE_VAR_BAZARR_API_KEY}}"
        - qBittorrent:
            icon: qbittorrent.png
            href: http://qbitt.homelab/
            description: Torrent client
            siteMonitor: http://qbitt.media.svc.cluster.local
            widget:
              type: qbittorrent
              url: http://qbitt.media.svc.cluster.local
              username: "{{HOMEPAGE_VAR_QBITTORRENT_USER}}"
              password: "{{HOMEPAGE_VAR_QBITTORRENT_PASSWORD}}"
        - Jackett:
            icon: jackett.png
            href: http://jackett.homelab/
            description: Indexer proxy
            siteMonitor: http://jackett.media.svc.cluster.local:9117

    - Media Management:
        - Jellyfin:
            icon: jellyfin.png
            href: http://jellyfin.homelab/
            description: Media streaming
            siteMonitor: http://jellyfin.media.svc.cluster.local:8096
            widget:
              type: jellyfin
              url: http://jellyfin.media.svc.cluster.local:8096
              key: "{{HOMEPAGE_VAR_JELLYFIN_API_KEY}}"
              enableBlocks: true
              enableNowPlaying: false
        - Jellyseerr:
            icon: jellyseerr.png
            href: http://jellyseerr.homelab/
            description: Request new media
            siteMonitor: http://jellyseerr.media.svc.cluster.local:5055
            widget:
              type: jellyseerr
              url: http://jellyseerr.media.svc.cluster.local:5055
              key: "{{HOMEPAGE_VAR_JELLYSEERR_API_KEY}}"

    # Column 3: Infrastructure
    - Infrastructure:
        - Longhorn:
            icon: longhorn.png
            href: http://longhorn.homelab/
            description: Block storage
            siteMonitor: http://longhorn-frontend.longhorn-system.svc.cluster.local
            widget:
              type: longhorn
              url: http://longhorn-frontend.longhorn-system.svc.cluster.local
        - Prometheus:
            icon: prometheus.png
            href: http://prometheus.homelab/
            description: Metrics
            siteMonitor: http://prometheus-operated.monitoring.svc.cluster.local:9090
            widget:
              type: prometheus
              url: http://prometheus-operated.monitoring.svc.cluster.local:9090
        - Grafana:
            icon: grafana.png
            href: http://grafana.homelab/
            description: Dashboards
            siteMonitor: http://monitoring-grafana.monitoring.svc.cluster.local
            widget:
              type: grafana
              url: http://monitoring-grafana.monitoring.svc.cluster.local
              username: "{{HOMEPAGE_VAR_GRAFANA_USER}}"
              password: "{{HOMEPAGE_VAR_GRAFANA_PASSWORD}}"
        - ArgoCD:
            icon: argocd.png
            href: http://argocd.homelab/
            description: GitOps CD
            siteMonitor: http://argocd-server.argocd.svc.cluster.local
        - OpenCost:
            icon: opencost.png
            href: http://opencost.homelab/
            description: Cost monitoring
            siteMonitor: http://opencost.opencost.svc.cluster.local:9090
        - Cert-Manager:
            icon: cert-manager.png
            description: TLS certificates
            widget:
              type: customapi
              url: http://cert-manager-webhook.cert-manager.svc.cluster.local:443/healthz
              mappings:
                - field: status
                  label: Status
                  format: text

    # Column 4: Other Apps
    - Other Apps:
        - Minio Console:
            icon: minio.png
            href: http://minio-console.homelab/
            description: Object storage
            siteMonitor: http://minio-console.minio.svc.cluster.local:9001
        - Minio S3 API:
            icon: minio.png
            href: http://s3.homelab/
            description: S3-compatible API
            siteMonitor: http://minio.minio.svc.cluster.local:9000
        - ESPHome:
            icon: esphome.png
            href: http://esphome.homelab/
            description: IoT device management
            siteMonitor: http://esphome.home-assistant.svc.cluster.local:6052
        - Acestream:
            icon: acestream.png
            href: http://acestream.homelab/
            description: P2P streaming
            siteMonitor: http://acestream.acestream.svc.cluster.local:6878
        - Mosquitto:
            icon: mqtt.png
            description: MQTT broker
            siteMonitor: http://mosquitto.mosquitto.svc.cluster.local:1883
        - FlareSolverr:
            icon: flaresolverr.png
            description: Cloudflare bypass
            siteMonitor: http://flaresolverr.media.svc.cluster.local:8191

    # Column 5: Roomio
    - Roomio:
        - Production:
            icon: https://roomiorentals.com/favicon.ico
            href: https://roomiorentals.com/
            description: Live site
            siteMonitor: https://roomiorentals.com/
        - Staging:
            icon: https://roomiorentals.com/favicon.ico
            href: https://staging.roomiorentals.com/
            description: Staging environment
            siteMonitor: https://staging.roomiorentals.com/
        - Development:
            icon: https://roomiorentals.com/favicon.ico
            href: https://dev.roomiorentals.com/
            description: Dev environment
            siteMonitor: https://dev.roomiorentals.com/

  widgets:
    - logo:
        icon: https://raw.githubusercontent.com/walkxcode/dashboard-icons/main/png/kubernetes.png
    - greeting:
        text_size: xl
        text: "Pablo's Homelab"
    - datetime:
        text_size: l
        format:
          dateStyle: long
          timeStyle: short
          hour12: false
    - openmeteo:
        label: Valencia
        latitude: 39.4699
        longitude: -0.3763
        units: metric
        cache: 5
    - search:
        provider: google
        target: _blank
    - kubernetes:
        cluster:
          show: true
          cpu: true
          memory: true
          showLabel: true
          label: "Cluster"
        nodes:
          show: true
          cpu: true
          memory: true
          showLabel: true


  # Kubernetes integration settings
  kubernetes:
    mode: cluster

  # General settings
  settings:
    title: "Pablo's Homelab"
    favicon: https://raw.githubusercontent.com/walkxcode/dashboard-icons/main/png/kubernetes.png
    theme: dark
    color: slate
    headerStyle: boxed
    hideVersion: true
    cardBlur: md
    statusStyle: dot
    layout:
      Home:
        style: column
        header: true
      Media Processing:
        style: column
        header: true
      Media Management:
        style: column
        header: true
      Infrastructure:
        style: column
        header: true
      Other Apps:
        style: column
        header: true
      Roomio:
        style: column
        header: true

# Environment variables loaded from Secret (created manually, not in Git)
# Create the secret with: kubectl apply -f homepage-secrets.yaml (keep this file local only!)
envFrom:
  - secretRef:
      name: homepage-secrets

# The service account is necessary to allow discovery of other services
serviceAccount:
  create: true
  name: homepage

# This enables the service account to access the necessary resources
enableRbac: true

ingress:
  main:
    # Disabled - using Cilium Gateway API instead
    enabled: false

persistence:
  logs:
    enabled: true
    type: pvc
    existingClaim: homepage  # Use manual PVC -> creates volume 'pvc-homepage'
    mountPath: /app/config/logs


controller:
  annotations:
    configmap-checksum: '{{ include (print $.Template.BasePath "/configmap.yaml") . | sha256sum }}'

# Prefer scheduling on worker node to balance cluster load
affinity:
  nodeAffinity:
    preferredDuringSchedulingIgnoredDuringExecution:
      - weight: 100
        preference:
          matchExpressions:
            - key: kubernetes.io/hostname
              operator: In
              values:
                - worker





